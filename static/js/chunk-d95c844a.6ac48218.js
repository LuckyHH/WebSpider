(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d95c844a"],{1460:function(t,i,e){"use strict";var n=e("b756"),a=e.n(n);a.a},"14e0":function(t,i,e){var n=e("63b6"),a=e("5d6b");n(n.S+n.F*(Number.parseInt!=a),"Number",{parseInt:a})},"3a3d":function(t,i,e){e("14e0"),t.exports=e("584a").Number.parseInt},"5d6b":function(t,i,e){var n=e("e53d").parseInt,a=e("a1ce").trim,s=e("e692"),o=/^[-+]?0[xX]/;t.exports=8!==n(s+"08")||22!==n(s+"0x16")?function(t,i){var e=a(String(t),3);return n(e,i>>>0||(o.test(e)?16:10))}:n},"675a":function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"manage"},[e("el-table",{staticClass:"api-table",attrs:{data:t.apis}},[e("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"expand"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"API地址"}},[e("span",[e("a",{attrs:{href:i.row.api,target:"_blank"}},[t._v(t._s(i.row.api))])])]),e("el-form-item",{attrs:{label:"开放权限"}},[e("span",[t._v(t._s(i.row.permission))])]),e("el-form-item",{attrs:{label:"更新间隔"}},[e("span",[t._v(t._s("0"===i.row.interval?"不更新":i.row.interval+" 小时"))])]),e("el-form-item",{attrs:{label:"标签"}},t._l(i.row.tag,function(i,n){return e("span",{key:n,staticStyle:{padding:"0 5px"}},[t._v(t._s(i))])}),0),e("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"描述信息"}},[e("span",[t._v(t._s(i.row.description))])])],1)]}}])}),e("el-table-column",{attrs:{label:"目标地址",prop:"config.url"}}),e("el-table-column",{attrs:{align:"right",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.onSideShow(i.row,i.$index,"edit")}}},[t._v("编辑")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(e){t.onSideShow(i.row,i.$index,"detials")}}},[t._v("详情")]),e("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(e){t.onSideShow(i.row,i.$index,"statistics")}}},[t._v("统计")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){t.onDeleteApi(i.row,i.$index)}}},[t._v("删除")])]}}])})],1),e("transition",{attrs:{name:"slide-fade"}},[t.showEdit?e("edit",{attrs:{editAPI:t.editAPI},on:{"change-state":t.onChangeState}}):t.showMore?e("detail",{attrs:{apiConfig:t.apiDetial},on:{"change-state":t.onChangeState}}):t.showStatistics?e("statistics",{attrs:{apiStatistics:t.apiStatistics},on:{"change-state":t.onChangeState}}):t._e()],1)],1)},a=[],s=e("70f1"),o=e.n(s),r=(e("cadf"),e("551c"),e("097d"),e("ef8d")),c=e("1c03");function l(t){var i="/statistics";return c["a"].get(i,t)}var d=e("f121"),u=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"edit"},[e("span",{staticClass:"close",on:{click:t.hiddenEdit}}),e("h2",[t._v("编辑")]),e("el-form",{ref:"form",attrs:{model:t.editAPI,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"目标网站"}},[e("el-input",{attrs:{disabled:!0},model:{value:t.editAPI.site,callback:function(i){t.$set(t.editAPI,"site",i)},expression:"editAPI.site"}})],1),e("el-form-item",{attrs:{label:"API-ID"}},[e("el-input",{attrs:{disabled:!0},model:{value:t.editAPI.cid,callback:function(i){t.$set(t.editAPI,"cid",i)},expression:"editAPI.cid"}})],1),e("el-form-item",{attrs:{label:"开放权限"}},[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.editAPI.permission,callback:function(i){t.$set(t.editAPI,"permission",i)},expression:"editAPI.permission"}})],1),e("el-form-item",{attrs:{label:"API标签"}},[t._l(t.editAPI.tag,function(i){return e("el-tag",{key:i,attrs:{closable:"","disable-transitions":!1},on:{close:function(e){t.handleClose(i)}}},[t._v("\n        "+t._s(i)+"\n      ")])}),t.inputVisible?e("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(i){return"button"in i||!t._k(i.keyCode,"enter",13,i.key,"Enter")?t.handleInputConfirm(i):null}},model:{value:t.inputValue,callback:function(i){t.inputValue=i},expression:"inputValue"}}):e("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ New Tag")])],2),e("el-form-item",{attrs:{label:"描述信息"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.editAPI.description,callback:function(i){t.$set(t.editAPI,"description",i)},expression:"editAPI.description"}})],1),e("el-form-item",{attrs:{label:"更新间隔"}},[e("el-input-number",{attrs:{size:"mini",step:.5,min:0},model:{value:t.editAPI.interval,callback:function(i){t.$set(t.editAPI,"interval",i)},expression:"editAPI.interval"}}),e("span",[t._v("小时")])],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交")]),e("el-button",{attrs:{type:"primary"},on:{click:t.hiddenEdit}},[t._v("取消")])],1)],1)],1)},f=[],p={name:"EditAPI",props:{editAPI:{type:Object,default:function(){return{}}}},data:function(){return{inputVisible:!1,inputValue:""}},methods:{hiddenEdit:function(){this.$emit("change-state","edit",!1)},onSubmit:function(){var t=this;Object(r["g"])({cid:this.editAPI.cid,permission:this.editAPI.permission,tag:this.editAPI.tag.slice(0,3),description:this.editAPI.description,interval:this.editAPI.interval}).then(function(i){i.data.state?t.$message.success("保存成功"):0===i.data.data.nModified?t.$message.info("配置未修改"):t.$message.error(i.data.msg)}).catch(function(i){t.$message.error(i)})},handleClose:function(t){this.editAPI.tag.splice(this.editAPI.tag.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick(function(i){t.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var t=this.inputValue;t&&this.editAPI.tag.push(t),this.inputVisible=!1,this.inputValue=""}}},h=p,v=(e("f0b3"),e("2877")),m=Object(v["a"])(h,u,f,!1,null,"e4e688b4",null);m.options.__file="edit.vue";var _=m.exports,g=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"details"},[e("span",{staticClass:"close",on:{click:t.hiddenDetails}}),e("h2",[t._v("详情")]),e("div",{staticClass:"main"},[e("table",[e("tr",[e("td",[t._v("目标网址")]),e("td",[t._v(t._s(t.apiConfig.config.url))])]),e("tr",[e("td",[t._v("深度")]),e("td",[t._v(t._s(t.apiConfig.config.depth))])]),e("tr",[e("td",[t._v("编码")]),e("td",[t._v(t._s(t.apiConfig.config.charset))])]),e("tr",[e("td",[t._v("抓取模式")]),e("td",[t._v(t._s("plain"===t.apiConfig.config.mode?"普通模式":"分页模式"))])]),e("tr",[e("td",[t._v("标签选择器")]),e("td",t._l(t.apiConfig.config.tags,function(i,n){return e("span",{key:n},[t._v(t._s(i))])}),0)]),e("tr",[e("td",[t._v("输出")]),e("td",[t._v(t._s(t.apiConfig.config.form))])]),"自定义代理"===t.apiConfig.config.proxyMode?e("tr",[e("td",[t._v("代理")]),e("td",t._l(t.apiConfig.config.proxies,function(i,n){return e("span",{key:n},[t._v(t._s(i))])}),0)]):t._e(),e("tr",[e("td",[t._v("代理模式")]),e("td",[t._v(t._s("none"===t.apiConfig.config.proxyMode?"无代理":"internal"===t.apiConfig.config.proxyMode?"内置代理":"自定义代理"))])]),"plain"!==t.apiConfig.config.mode?e("tr",[e("td",[t._v("起始页")]),e("td",[t._v(t._s(t.apiConfig.config.start))])]):t._e(),"plain"!==t.apiConfig.config.mode?e("tr",[e("td",[t._v("终止页")]),e("td",[t._v(t._s(t.apiConfig.config.end))])]):t._e(),e("tr",[e("td",[t._v("权限")]),e("td",[t._v(t._s(t.apiConfig.permission))])]),e("tr",[e("td",[t._v("更新间隔")]),e("td",[t._v(t._s(t.apiConfig.interval))])]),e("tr",[e("td",[t._v("API标签")]),e("td",t._l(t.apiConfig.tag,function(i,n){return e("span",[t._v(t._s(i))])}),0)]),e("tr",[e("td",[t._v("描述信息")]),e("td",[t._v(t._s(t.apiConfig.description))])]),t._m(0)])])])},b=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("tr",[e("td")])}],w={name:"Details",props:{apiConfig:{type:Object,default:function(){return{}}}},methods:{hiddenDetails:function(){this.$emit("change-state","detials",!1)}}},I=w,S=(e("1460"),Object(v["a"])(I,g,b,!1,null,"4dfbee02",null));S.options.__file="details.vue";var y=S.exports,C=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"statistics"},[e("span",{staticClass:"close",on:{click:t.hiddenDetails}}),e("h2",[t._v("API调用统计")]),t.apiStatistics.state?e("div",{staticClass:"main"},[e("table",[e("tr",[e("td",[t._v(t._s(t.apiStatistics.api))])]),e("tr",[e("td",[t._v("该API创建于"+t._s(t.apiStatistics.time)+"，距今共计调用"+t._s(t.apiStatistics.count)+"次")])])]),e("p",[t._v("调用列表如下")]),t._l(t.apiStatistics.history,function(i,n){return e("ul",{key:n,staticClass:"year"},[e("li",[t._v("\n        "+t._s(i.year)+"年\n      ")]),e("li",t._l(i.data,function(i,n){return e("ul",{key:n,staticClass:"month"},[e("li",[t._v(t._s(i.month)+"月")]),t._l(i.data,function(i,n){return e("li",{key:n,staticClass:"date"},[e("ul",[e("li",[t._v(t._s(i.day)+"日")]),e("li",t._l(i.data,function(i,n){return e("ul",{key:n,staticClass:"time"},[e("li",[t._v(t._s(i))])])}),0)])])})],2)}),0)])}),e("div",{staticStyle:{"padding-bottom":"50px"}})],2):e("div",[e("p",[t._v("该API尚未初始化，没有该API调用信息")])])])},A=[],P={name:"Statistics",props:{apiStatistics:{type:Object,default:function(){return{}}}},methods:{hiddenDetails:function(){this.$emit("change-state","statistics",!1)}}},x=P,k=(e("724d"),Object(v["a"])(x,C,A,!1,null,"e4d3f212",null));k.options.__file="statistics.vue";var $=k.exports,E={name:"Manage",components:{Edit:_,Detail:y,Statistics:$},data:function(){return{apis:[],editAPI:{},apiDetial:{config:{}},apiStatistics:{},page:0,pageSize:10,showEdit:!1,showMore:!1,showStatistics:!1}},methods:{onSideShow:function(t,i,e){var n=document.querySelector(".api-table");n.style.width="calc(100% - 400px)","edit"===e?(this.editAPI={site:t.config.url,cid:t.cid,tag:t.tag,description:t.description,permission:t.permission,interval:t.interval},this.showEdit=!0,this.showMore=!1,this.showStatistics=!1):"detials"===e?(this.apiDetial=t,this.showMore=!0,this.showEdit=!1,this.showStatistics=!1):(this.showMore=!1,this.showEdit=!1,this.showStatistics=!0,this.getStatistics(t))},getStatistics:function(t){var i=this,e=t.cid;l({cid:e}).then(function(t){if(t.data.state){var e=t.data.data[0],n=e.time,a=e.url,s=e.count,r=e.history;i.apiStatistics={state:!0,api:a,count:s,history:r,time:new Date(o()(n)).toLocaleString()}}else i.apiStatistics={state:!1}}).catch(function(t){console.log("出错啦")})},onChangeState:function(t,i){var e=document.querySelector(".api-table");e.style.width="100%","edit"===t?this.showEdit=i:"detials"===t?this.showMore=i:this.showStatistics=i},onDeleteApi:function(t,i){var e=this,n=t.cid;this.$confirm("此操作将永久删除配置, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return Object(r["a"])({cid:n})}).then(function(t){t.data.state?(e.apis.splice(i,1),e.$message({type:"success",message:"删除成功!"})):(e.$message({type:"error",message:t.data.data}),console.log("配置删除失败",t.data.data))}).catch(function(){e.$message.info("已取消删除")})}},activated:function(){var t=this;this.$store.state.user||this.$router.push("enter"),Object(r["b"])({page:this.page,pageSize:this.pageSize}).then(function(i){i.data.state?t.apis=i.data.data.map(function(t){return t.api="".concat(d["a"].baseUrl||window.location.origin,"/crawl/api?user=").concat(t.author,"&cid=").concat(t.cid),t}):t.$message.error(i.data.msg)}).catch(function(t){console.log("捕获到错误",t)})}},D=E,O=(e("c8bd"),Object(v["a"])(D,n,a,!1,null,null,null));O.options.__file="manage.vue";i["default"]=O.exports},"70f1":function(t,i,e){t.exports=e("3a3d")},"724d":function(t,i,e){"use strict";var n=e("eaf7"),a=e.n(n);a.a},a1ce:function(t,i,e){var n=e("63b6"),a=e("25eb"),s=e("294c"),o=e("e692"),r="["+o+"]",c="​",l=RegExp("^"+r+r+"*"),d=RegExp(r+r+"*$"),u=function(t,i,e){var a={},r=s(function(){return!!o[t]()||c[t]()!=c}),l=a[t]=r?i(f):o[t];e&&(a[e]=l),n(n.P+n.F*r,"String",a)},f=u.trim=function(t,i){return t=String(a(t)),1&i&&(t=t.replace(l,"")),2&i&&(t=t.replace(d,"")),t};t.exports=u},ab6c:function(t,i,e){},ad00:function(t,i,e){},b756:function(t,i,e){},c8bd:function(t,i,e){"use strict";var n=e("ad00"),a=e.n(n);a.a},e692:function(t,i){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},eaf7:function(t,i,e){},ef8d:function(t,i,e){"use strict";e.d(i,"d",function(){return a}),e.d(i,"e",function(){return s}),e.d(i,"b",function(){return o}),e.d(i,"g",function(){return r}),e.d(i,"a",function(){return c}),e.d(i,"c",function(){return l}),e.d(i,"f",function(){return d});var n=e("1c03");function a(t){var i="/crawl/share";return n["a"].get(i,t)}function s(t){console.log(t);var i="/crawl/tag";return n["a"].get(i,t)}function o(t){var i="/crawl/config";return n["a"].get(i,t)}function r(t){var i="/crawl/config";return n["a"].post(i,t)}function c(t){var i="/crawl/config";return n["a"].delete(i,t)}function l(t){var i="/crawl/preview";return n["a"].post(i,t)}function d(t){var i="/crawl/save";return n["a"].post(i,t)}},f0b3:function(t,i,e){"use strict";var n=e("ab6c"),a=e.n(n);a.a}}]);
//# sourceMappingURL=chunk-d95c844a.6ac48218.js.map